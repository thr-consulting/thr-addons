<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"SharedCache.ts.html":{"id":"SharedCache.ts.html","title":"Source: SharedCache.ts","body":" Documentation Classes SharedCache Source: SharedCache.ts /* eslint-disable no-underscore-dangle */ import Redis from 'ioredis'; function getRedisKey(prefix: string, key: string): string { return prefix ? `${prefix}:${key}` : key; } function toString(value: any): string { if (value === null) return ''; if (typeof value === 'object') return JSON.stringify(value); return value; } function parse(value: string): {} | null { if (value === '' || value === null) return null; return JSON.parse(value); } export default class SharedCache { /** * Constructs a new SharedCache * @param prefix * @param expire */ constructor({prefix, expire}: {prefix?: string, expire?: number}) { if (process.env.DISABLE_REDIS === 'true') { this._redis = null; } else { this._redis = new Redis({ port: parseInt(process.env.REDIS_PORT || '6379', 10), host: process.env.REDIS_HOST || '127.0.0.1', }); } if (process.env.REDIS_EXPIRE) { this._expire = parseInt(process.env.REDIS_EXPIRE || '0', 10); } else if (expire) { this._expire = expire; } else { this._expire = null; } this._prefix = prefix || ''; } _redis: Redis.Redis | null; _expire: number | null; _prefix: string; /** * Sets a key value pair with optional expiry (in seconds). * @param key * @param data * @param expire * @return {Promise&lt;*&gt;} */ async set(key: string, data: any, expire?: number) { if (!this._redis) return data; const multi = this._redis.multi(); multi.set(getRedisKey(this._prefix, key), toString(data)); if (this._expire || expire) multi.expire(getRedisKey(this._prefix, key), expire || this._expire); return new Promise((resolve, reject) =&gt; { multi.exec(error =&gt; { if (error) reject(error); else resolve(data); }); }); } /** * Gets the value of a key. Returns null if the key does not exist. * @param key * @return {Promise&lt;*&gt;} The value or null. */ async get(key) { if (!this._redis) return null; return parse(await this._redis.get(getRedisKey(this._prefix, key))); } /** * Checks if the key exists in the store. * @param key * @return {Promise&lt;boolean&gt;} Returns true if the key is found, otherwise false. */ async exists(key) { if (!this._redis) return false; return !!await this._redis.exists(getRedisKey(this._prefix, key)); } /** * Removes a key from the store * @param key * @return {Promise&lt;boolean&gt;} True if they key exists and is cleared, otherwise false */ async clear(key) { if (!this._redis) return false; return !!await this._redis.del(getRedisKey(this._prefix, key)); } /** * Clears all keys from the current prefix. * @return {Promise&lt;any&gt;} */ clearAll() { return new Promise((resolve, reject) =&gt; { if (!this._redis) { resolve(); } else { const stream = this._redis.scanStream({match: `${this._prefix}:*`}); stream.on('data', keys =&gt; { if (keys.length) { const pipeline = this._redis.pipeline(); keys.forEach(key =&gt; { pipeline.del(key); }); pipeline.exec(); } }); stream.on('error', reject); stream.on('end', resolve); } }); } } × Search results Close Documentation generated by JSDoc 3.5.5 on 2019-05-19T23:16:07-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Classes SharedCache Classes Classes SharedCache × Search results Close Documentation generated by JSDoc 3.5.5 on 2019-05-19T23:16:07-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Classes SharedCache sidebar_label: Extras title: Extras Extra utilities Installyarn add @thx/extras × Search results Close Documentation generated by JSDoc 3.5.5 on 2019-05-19T23:16:07-05:00 using the DocStrap template. "},"SharedCache.html":{"id":"SharedCache.html","title":"Class: SharedCache","body":" Documentation Classes SharedCache Class: SharedCache SharedCache new SharedCache(prefix, expire) Constructs a new SharedCache Parameters: Name Type Description prefix expire Source: SharedCache.ts, line 34 Methods &lt;async&gt; clear(key) Removes a key from the store Parameters: Name Type Description key Source: SharedCache.ts, line 111 Returns: True if they key exists and is cleared, otherwise false Type Promise.&lt;boolean&gt; clearAll() Clears all keys from the current prefix. Source: SharedCache.ts, line 121 Returns: Type Promise.&lt;any&gt; &lt;async&gt; exists(key) Checks if the key exists in the store. Parameters: Name Type Description key Source: SharedCache.ts, line 100 Returns: Returns true if the key is found, otherwise false. Type Promise.&lt;boolean&gt; &lt;async&gt; get(key) Gets the value of a key. Returns null if the key does not exist. Parameters: Name Type Description key Source: SharedCache.ts, line 89 Returns: The value or null. Type Promise.&lt;*&gt; &lt;async&gt; set(key, data, expire) Sets a key value pair with optional expiry (in seconds). Parameters: Name Type Description key data expire Source: SharedCache.ts, line 69 Returns: Type Promise.&lt;*&gt; × Search results Close Documentation generated by JSDoc 3.5.5 on 2019-05-19T23:16:07-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
